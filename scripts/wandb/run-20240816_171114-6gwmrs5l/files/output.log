{'seed': 0, 'dataset_name': 'test_1', 'do_train': True, 'load_model': '../../scGPT/save/scGPT_human', 'mask_ratio': 0.0, 'epochs': 10, 'n_bins': 51, 'MVC': False, 'ecs_thres': 0.0, 'dab_weight': 0.0, 'lr': 0.0001, 'batch_size': 32, 'layer_size': 128, 'nlayers': 4, 'nhead': 4, 'dropout': 0.2, 'schedule_ratio': 0.9, 'save_eval_interval': 5, 'fast_transformer': True, 'pre_norm': False, 'amp': True, 'include_zero_gene': False, 'freeze': False, 'DSBN': False}
save to save/dev_test_1-Aug16-17-11
2024-08-16 17:11:33,731 - Presence thr 10053.85, 7192 genes left
2024-08-16 17:11:33,865 - Presence thr 10053.85, 7192 genes left
2024-08-16 17:11:34,865 - Variance thr 6547654.53, 9085 genes left
2024-08-16 17:11:34,865 - Combined mask nÂº of genes 3000
scGPT - INFO - match 2996/3000 genes in vocabulary of size 60697.
scGPT - INFO - Resume model from ../../scGPT/save/scGPT_human/best_model.pt, the model args will override the config ../../scGPT/save/scGPT_human/args.json.
scGPT - INFO - Normalizing total counts ...
scGPT - INFO - Log1p transforming ...
scGPT - WARNING - The input data seems to be already log1p transformed. Set `log1p=False` to avoid double log1p transform.
scGPT - INFO - Binning data ...
scGPT - INFO - Normalizing total counts ...
scGPT - INFO - Log1p transforming ...
scGPT - WARNING - The input data seems to be already log1p transformed. Set `log1p=False` to avoid double log1p transform.
scGPT - INFO - Binning data ...
scGPT - INFO - train set number of samples: 7619,
	 feature length: 2997
scGPT - INFO - valid set number of samples: 847,
	 feature length: 2997
scGPT - INFO - Total Pre freeze Params 51335176
scGPT - INFO - Total Post freeze Params 51335176
random masking at epoch   1, ratio of masked values in train:  0.0000
scGPT - INFO - | epoch   1 | 100/239 batches | lr 0.0001 | ms/batch 477.10 | loss  1.23 | cls  1.23 | err  0.46 |
scGPT - INFO - | epoch   1 | 200/239 batches | lr 0.0001 | ms/batch 461.13 | loss  0.99 | cls  0.99 | err  0.38 |
scGPT - INFO - -----------------------------------------------------------------------------------------
scGPT - INFO - | end of epoch   1 | time: 115.98s | valid loss/mse 0.9711 | err 0.3790
scGPT - INFO - -----------------------------------------------------------------------------------------
scGPT - INFO - Best model with score 0.9711